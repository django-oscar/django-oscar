{% extends "customer/baseaccountpage.html" %}
{% load i18n %}
{% load url from future %}

{% block tabcontent %}

{% if form.total_form_count %}
<form class="stacked" method="post">
    {{ form.management_form }}
    {% csrf_token %}
    <table class="table table-striped table-bordered">
        <tbody>
        <tr>
            <th>{% trans 'Product' %}</th>
            <th>{% trans 'Quantity' %}</th>
            <th>{% trans 'Action' %}</th>
        </tr>

        {% for form in form %}
            {% with line=form.instance %}
            <tr>
                <td>
                    {{ line.get_title }}
                    {% if not line.product %}
                    <em>({% trans 'not available anymore' %})</em>
                    {% endif %}
                </td>
                <td>
                    {% for field in form %}
                        {{ field }}
                        {% for error in field.errors %}
                            <ul class="help-block">
                                <li>{{ error }}</li>
                            </ul>
                        {% endfor %}
                    {% endfor %}
                <td>
                    <div class="btn-group">
                        {% if line.product %}
                            <a class="btn" href="{{ line.product.get_absolute_url }}">{% trans 'View Product' %}</a>
                            <button class="btn dropdown-toggle" data-toggle="dropdown">
                                <span class="caret"></span>
                            </button>
                        {% else %}
                            <a class="btn dropdown-toggle" data-toggle="dropdown" href="#">
                                {% trans 'Actions' %}
                                <span class="caret"></span>
                            </a>
                        {% endif %}
                        <ul class="dropdown-menu">
                            <li><a href="{% url 'customer:wishlists-remove-product' key=wishlist.key line_pk=line.pk %}">
                                {% trans 'Remove from wishlist' %}
                            </a></li>
                            {% for other_wishlist in other_wishlists %}
                                <li><a href="{% url 'customer:wishlists-move-product-to-another' key=wishlist.key line_pk=line.pk to_key=other_wishlist.key %}">
                                    {% blocktrans with name=other_wishlist.name %}
                                    Move to {{ name }}
                                    {% endblocktrans %}
                                </a></li>
                            {% endfor %}
                        </ul>
                    </div>
                </td>
            </tr>
            {% endwith %}
        {% endfor %}
        </tbody>
    </table>
    <div class="form-actions">
        <button class="btn btn-large btn-primary" type="submit">{% trans "Update quantities" %}</button>
        {% trans "or" %} <a href="{% url 'customer:wishlists-list' %}">{% trans "cancel" %}</a>
    </div>
</form>

{% else %}
    {% trans "Your wish list is empty." %}
{% endif %}

{% endblock tabcontent %}
